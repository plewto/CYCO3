<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="robots" content="index,follow,archive">
    <meta name="description" content="CYCO Documentation">
    <link rel="stylesheet" type="text/css" href="style.css"/>
    <link rel="icon" href="icon.png"/>
    <title>PigIron</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=PT+Serif' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'/>
    
</head>

<body>
<div id="page_wrapper">
<a class="navigation" href="home.html">Home</a>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="navigation" href="contents.html">Contents</a>
&nbsp;&nbsp;&nbsp;&nbsp;<b class="navigation">Previous:</b>&nbsp;<a class="navigation" href="osc.html">Osc</a>
&nbsp;&nbsp;&nbsp;&nbsp;<b class="navigation">Next:</b>&nbsp;<a class="navigation" href="contents.html">Contents</a>

<img class="center" src="pigiron.png" alt="PigIron Logo"/>
<h2 class="section-head">PigIron</h2>
<p class="body">
    <br><br></p>
<p class="body">
    PigIron is a MIDI routing utility with an integrated MIDI file player and OSC support.&nbsp;    It is currently (2018.11.26) in very early development but basic functionality is up.&nbsp; The     functions described here should be considered as provisional.&nbsp;        PigIron is available as an Intellij Kotlin project <a href=''>where?</a></p>
<p class="body">
    For CYCO to communicate with PigIron you must first load the optional pigiron     <a href='configuration.html'>profile.</a></p>
<pre class="code">
(load-profile 'pigiron)
</pre>
<p class="body">
    This defines a new Lisp package named :pigiron and imports     several new functions into the CYCO package.&nbsp; The new functions fall into two general     categories:</p>
<ol>
    <li>Functions which query the current state of PigIron.</li>
    <li>Functions which instruct PigIron to reconfigure itself.</li>
</ol>
<p class="body">
    Since OSC reception has not been implemented in CYCO, communication is one    way only.&nbsp; PigIron does not yet have a GUI and the results of the    type-1 'query' messages are printed to the terminal where PigIron was launched.</p>
<p class="footnote">PigIron acknowledges receipt of most OSC messages with a return message
but CYCO promptly ignores them.  Getting OSC reception up on CYCO will
probably involve creating a separate thread to prevent interruption of the
REPL loop.</p>
<p class="body">
    The 'query' type functions all have names which begin with a question mark    and then the word 'pig'.</p>
<pre class="code">
(?pig-something)
</pre>
<hr/>
<h4 class="section-head">General Messages</h4>
<b class="definition">(PIG-PING)</b><br>
<p class="synopsis">Diagnostic to check OSC connectivity between PigIron and
CYCO.  PigIron should display something in response to a ping message.</p>
<b class="definition">(?PIG-FOREST)</b><br>
<p class="synopsis">Print representation of all MIDI process trees.</p>
<b class="definition">(?PIG-TRANSMITTERS)</b><br>
<p class="synopsis">Print list of available MIDI transmitters.  These values
  are necessary when creating MIDI input ports.</p>
<b class="definition">(?PIG-RECEIVERS)</b><br>
<p class="synopsis">Prints list of available MIDI receivers.  These values
are necessary when creating MIDI output ports.</p>
<b class="definition">(?PIG-OPERATORS)</b><br>
<p class="synopsis">Print names of all operators.</p>
<b class="definition">(?PIG-OPTYPES)</b><br>
<p class="synopsis">Print list of all operator types.</p>
<b class="definition">(PIG-PANIC)</b><br>
<p class="synopsis">Instructs PigIron to stop all notes.  
ISSUE: not currently implemented</p>
<b class="definition">(PIG-RESET)</b><br>
<p class="synopsis">Reset all operators to initial state.
ISSUE: not currently implemented.</p>
<b class="definition">(PIG-CLEAR-FOREST)</b><br>
<p class="synopsis">Remove all active operators.</p>
<b class="definition">(PIG-SYNC-UI)</b><br>
<p class="synopsis">The PigIron GUI is not automatically refreshed when changes
are made over OSC.  PIG-SYNC-UI instructs that the GUI should be updated.</p>
<p class="footnote">This is aspirational, PigIron does not currently implement a GUI. For the 
moment pig-sync-ui does nothing.</p>
<b class="definition">(PIG-ISOLATE-OPERATOR opname)</b><br>
<p class="synopsis">Removes all input and output connections to the operator.
An operator must be 'isolated' before it can be removed.</p>
<b class="definition">(PIG-FORGET-OPERATOR opname)</b><br>
<p class="synopsis">Delete the named operator.  The operator must be
'isolated' first.</p>
<b class="definition">(PIG-CONNECT parent child)</b><br>
<p class="synopsis">Make a connection between parent and child operators.  The
parent serves as an input to the child.&nbsp; If any of the following
conditions arise the connection is aborted and a warning message
displayed.</p>
<ol>
    <li>Tree depth exceeds some maximum. <em class='footnote'>10 I
	   believe but this value may change.</em></li>
    <li>Circular connections</li>
    <li>Parallel paths between any two operators</li>
</ol>
<pre class="code">
Examples:

;; Connect input port to output port.
;;
(pig-connect 'midi-input-1 'midi-output-1)

	 
;; Invalid circular connection
;;
(pig-connect 'channel-filter-1 'channel-distributor-1)
(pig-connect 'channel-distributor-1 'channel-filter-1)


;; Invalid parallel paths between input and output 
;; operators.
;;
(pig-connect 'midi-input-1 'midi-output-1)
(pig-connect 'midi-input-1 'channel-filter-1)
(pig-connect 'channel-filter-1 'midi-output-1) 
</pre>
<b class="definition">(PIG-DISCONNECT parent child)</b><br>
<p class="synopsis">Remove parent as an input to child.</p>
<b class="definition">(PIG-CREATE-OPERATOR optype &key (parent nil)(id nil))</b><br>
<p class="synopsis">Create new operator with optional initial parent (input) and
id.  Use ?PIG-OPTYPES to see list of operator types.</p>
<p class="synopsis">Operator names have the form <em>optype-id</em> and must be
unique. PigIron will automatically assign an integer id for each operator
type starting with the value 1.  If you wish you may suggest an explicit
id.  If your value conflicts with an existing name, PigIron will promptly
ignore your suggestion and select a valid value.</p>
<pre class="code">
Example, create new midi input and output ports, connect them together.

(pig-create-operator 'midi-input :id 5)
(pig-create-operator 'midi-output :parent midi-input-5)	 

;; This example is not quite complete. While it creates the input and
;; output ports and connects them together, no MIDI devices have been
;; specified.  Initially the input and output ports use dummy 'null'
;; devices.  The null devices implement the required Java interfaces but
;; do not provide real functionality.  Use (?PIG-TRANSMITTERS) and 
;; (?PIG-RECEIVERS) to view available MIDI devices, then use 
;; (PIG-SET-MIDI-DEVICE opname device-name) to establish the devices.
;; 
</pre>
<hr/>
<h4 class="section-head">Channel Selection Operators</h4>
<p class="body">
    Two operator types manipulate sets of MIDI channels    and share a common set of functions.&nbsp; Any number of channels may be    selected simultaneously.</p>
<ol>
    <li>channel-filter - selectively block/pass message based on channel.</li>
    <li>channel-distributor - retransmit incoming messages on each selected output channel.
The channel of the input message is irrelevant.</li>
</ol>
<b class="definition">(?PIG-CHANNEL-ENABLED op channel)</b><br>
<p class="synopsis">Checks if specific channel is enabled.</p>
<b class="definition">(PIG-ENABLE-CHANNEL op channel flag)</b><br>
<p class="synopsis">Enables/disables operator channel.</p>
<b class="definition">(PIG-ENABLE-ALL-CHANNELS op flag)</b><br>
<p class="synopsis">Enables/disables all operator channels.</p>
<hr/>
<h4 class="section-head">Input and Output Ports</h4>
<b class="definition">(?PIG-MIDI-DEVICE op)</b><br>
<p class="synopsis">Display MIDI device in use by operator.</p>
<b class="definition">(PIG-SET-MIDI-DEVICE op devname)</b><br>
<p class="synopsis">Sets MIDI device used by port.&nbsp; Use ?PIG-TRANSMITTERS and
?PIG-RECEIVERS for list of devices.&nbsp;  A partial device name may be used.</p>
<hr/>
<h4 class="section-head">MIDI File Player</h4>
<p class="body">
    All functions related to the MIDI file player take     an optional :op keyword argument.  op defaults to     <nobr>*MIDI-FILE-PLAYER-ID*</nobr> which holds the name of the     player operator.</p>
<b class="definition">(?PIG-MIDI-FILENAME &key op)</b><br>
<p class="synopsis">Display current filename of current MIDI file.</p>
<b class="definition">(?PIG-IS-PLAYING &key op)</b><br>
<p class="synopsis">Displays if MIDI file player is currently playing.</p>
<b class="definition">(PIG-LOAD-MIDI-FILE filename &key op)</b><br>
<b class="definition">(PIG-PLAY &key filename delay op)</b><br>
<p class="synopsis">Commence MIDI file playback.  If filename is specified load prior to 
playback.  The delay argument sets a delay time between file load and playback commencement, 
it is ignored if a filename has not been specified.</p>
<b class="definition">(PIG-STOP &key op)</b><br>
<p class="synopsis">Halt MIDI file playback.</p>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#top">Top</a>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="navigation" href="home.html">Home</a>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="navigation" href="contents.html">Contents</a>
&nbsp;&nbsp;&nbsp;&nbsp;<b class="navigation">Previous:</b>&nbsp;<a class="navigation" href="osc.html">Osc</a>
&nbsp;&nbsp;&nbsp;&nbsp;<b class="navigation">Next:</b>&nbsp;<a class="navigation" href="contents.html">Contents</a>

</div>
</body>
</html>
