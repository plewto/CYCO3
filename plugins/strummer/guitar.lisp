;;;; CYCO strummer plugin guitar chord model
;;;;

(constant +GUITAR-CHORDS+ (fret-model 'fm-guitar 25 '(e4 a4 d5 g5 b5 e6)))

(defun ?guitar-neck (&optional (select '(0 1 2 3 4 5 6 7 8 9 10 11)))
  "Display guitar note positions.
   select - list, only display pitch classes in list."
  (format t "~a~%" (format-neck +guitar-chords+ :select (pitch-class select))))

(defun ?guitar-chords ()
  "Display list of defined guitar chords."
  (?chords +guitar-chords+))

;; solo
;; maj
;; maj7
;; min

;; sus4

(define-chord-family! +GUITAR-CHORDS+ '[solo]
  :e  '(( 0  x  x  x  x  x)
        ( x  x  2  x  x  x)
        ( x  x  x  x  x  0)
        ( x  x  x  x  x 12))
  :f  '(( 1  x  x  x  x  x)
	( x  x  3  x  x  x)
	( x  x  x  x  x  1)
	( x  x  x  x  x 13))
  :fs '(( 2  x  x  x  x  x)
	( x  x  4  x  x  x)
	( x  x  x  x  x  2)
	( x  x  x  x  x 14))
  :g  '(( 3  x  x  x  x  x)
	( x  x  x  0  x  x)
	( x  x  x  x  x  3)
	( x  x  x  x  x 15))
  :gs '(( 4  x  x  x  x  x)
	( x  x  x  1  x  x)
	( x  x  x  x  x  4)
	( x  x  x  x  x 16))
  :a  '(( x  0  x  x  x  x)
	( x  x  x  2  x  x)
	( x  x  x  x  x  5)
	( x  x  x  x  x 17))
  :as '(( x  1  x  x  x  x)
	( x  x  x  3  x  x)
	( x  x  x  x  x  6)
	( x  x  x  x  x 18))
  :b  '(( x  2  x  x  x  x)
	( x  x  x  x  0  x)
	( x  x  x  x  x  7)
	( x  x  x  x  x 19))
  :c  '(( x  3  x  x  x  x)
	( x  x  x  x  1  x)
	( x  x  x  x  x  8)
	( x  x  x  x  x 20))
  :cs '(( x  4  x  x  x  x)
	( x  x  x  x  2  x)
	( x  x  x  x  x  9)
	( x  x  x  x  x 21))
  :d  '(( x  x  0  x  x  x)
	( x  x  x  x  3  x)
	( x  x  x  x 15  x))
  :ds '(( x  x  1  x  x  x)
	( x  x  x  x  4  x)
	( x  x  x  x 16  x)))

(define-chord-family! +GUITAR-CHORDS+ '[maj]
  :e  '(( 0  2  2  1  0  0) ;; E B E GS B E
	( X  X  2  4  5  4)
	( X  7  6  4  5  4)
	( X  7  9  9  9  7)
	(12 11  9  9  9 12)
	(12 14 14 13 12 12))
  :f  '(( 1  3  3  2  1  1)
	( X  X  3  5  6  5)
	( X  8  7  5  6  5)
	( X  8 10 10 10  8))
  :fs '(( 2  4  4  3  2  2)
	( X  X  4  6  7  6)
	( X  9  8  6  7  6)
	( X  9 11 11 11  9))
  :g  '(( 3  2  0  0  0  3)
	( 3  5  5  4  3  3)
	( X  X  5  7  8  7)
	( X 10  9  7  8  7)
	( X 10 12 12 12 10))
  :gs '(( 4  3  1  1  1  4)
	( 4  6  6  5  4  4)
	( X  X  6  8  9  8)
	( X 11 10  8  9  8)
	( X 11 13 13 13 11))
  :a  '(( X  0  2  2  2  0)
	( 5  7  7  6  5  5)
	( 5  4  2  2  2  5)
	( X  X  7  9 10  9)
	( X 12 11  9 10  9))
  :as '(( X  1  3  3  3  1)
	( 6  8  8  7  6  6)
	( 6  5  3  3  3  6)
	( x  x  8 10 11 10))
  :b  '(( x  2  4  4  4  2)
	( 7  6  4  4  4  7)
	( 7  9  9  8  7  7)
	( x  x  9 11 12 11))
  :c  '(( x  3  2  0  1  0)
	( x  3  2  0  1  3)
	( x  3  5  5  5  3)
	( 8 10 10  9  8  8)
	( 8  7  5  5  5  8)              
	( X  X 10 12 13 12))
  :cs '(( x  4  3  1  2  1)
	( x  4  6  6  6  4)
	( 9  8  6  6  6  9)
	( 9 11 11 10  9  9))
  :d  '(( x  x  0  2  3  2)
	( x  5  7  7  7  5)
	(10  9  7  7  7 10)
	(10 12 12 11 10 10))
  :ds '(( x  6  5  3  4  3)
	( x  6  8  8  8  6)
	(11 10  8  8  8 11) 
	(11 13 13 12 11 11)))



(define-chord-family! +GUITAR-CHORDS+ '[maj7]
  :e  '(( x  x  2  4  4  4) ;; E B EF B
	( x  7  6  4  4  7)
	( x  7 10  9 10  7)
	(12  x 13 13 12  x)
	( x  x 14 13 12 11)
	(12 14 13 13 12 12))
  :f  '(( 1  x  2  2  1  x)
	( 1  3  2  2  1  1)
	( x  x  3  5  5  5)
	( x  8  7  5  5  8)
	( x  8 10  9 10  8)
	( x  x 15 14 13 12))
  :fs '(( 2  x  3  3  2  x)
	( x  x  4  3  2  1)
	( 2  4  3  3  2  2)
	( x  x  4  6  6  6)
	( x  9  8  6  6  9)
	( x  9 11 10 11  9))
  :g  '(( 3  5  4  4  3  3)
	( 3  x  4  4  3  x)
	( x  x  5  4  3  2)
	( x  x  5  7  7  7)
	( x 10  9  7  7 10)
	( x 10 12 11 12 10))
  :gs '(( x  x  6  5  4  3)
	( x  x  6  8  8  8)
	( 4  6  5  5  4  4)
	( 4  x  5  5  4  x)
	( x 11 10  8  8 11)
	( x 11 13 12 13 11))
  :a  '(( x  x  7  6  5  4)
	( x  x  7  9  9  9)
	( 5  7  6  6  5  5)
	( 5  x  6  6  5  x)
	( x 12 11  9  9 12)
	( x 12 14 13 14 12))
  :as '(( x  1  3  2  3  1)
	( 6  x  7  7  6  x)
	( 6  8  7  7  6  6)
	( x  x  8  7  6  5)
	( x  x  8 10 10 10)
	( x 13 12 10 10 13))
  :b  '(( x  2  4  3  4  2)
	( x  x  9  8  7  6)
	( 7  9  8  8  7  7)
	( 7  x  8  8  7  x)
	( x  x  9 11 11 11)
	( x 14 13 11 11 14))
  :c  '(( x  3  5  4  5  3)
	( x  x 10  9  8  7)
	( x  x 10 12 12 12)
	( 8  x  9  9  8  x)
	( 8 10  9  9  8  8)
	( x 15 14 11 11 15))
  :cs '(( x  4  6  5  6  4)
	( 9 11 10 10  9  9)
	( x  4  3  1  1  4)
	( x  x 11 10  9  8)
	( x  x 11 13 13 13)
	( 9  x 10 10  9  x))
  :d  '(( x  5  7  6  7  5)
	(10 12 11 11 10 10)
	( x  5  4  2  2  5)
	( x  x 12 11 10  9)
	( x  x 12 14 14 14)
	(10  x 11 11 10  x))
  :ds '(( x  6  8  7  8  6)
	(11 13 12 12 11 11)
	( x  6  5  3  3  6)
	( x  x 13 12 11 10)
	( x  x  1  3  3  3)
	(11  x 12 12 11  x)))


(define-chord-family! +GUITAR-CHORDS+ '[7]
  :e  '(( 0  2  2  1  3  0) ;; E B E GS D E
	( 0  2  0  1  0  0)
	( x  2  0  1  3  0)
	( x  x  0  1  0  0)
	( 4  x  2  4  3  x)
	( x  5  x  4  5  4)
	( 7  7  6  7  5  x)
	( x  7  9  9  9 10))
  :f  '(( 1  3  1  2  1  1)
	( 1  3  x  2  4  x)
	( x  x  1  2  1  1)
	( 1  3  x  2  4  x)
	( x  3  3  5  4  5)
	( x  6  x  5  6  5)
	( 8  8  7  8  6  x)
	( 8  8 10  8 10  8))
  :fs '(( 2  4  2  3  2  2)
	( 2  x  2  3  2  x)
	( x  x  4  3  2  0)
	( 2  4  x  3  5  x)
	( x  4  4  6  5  6)
	( 9  9  8  9  7  x))
  :g  '(( 3  2  0  0  0  1)
	( 3  x  3  4  3  x)
	( 3  5  3  4  3  3)
	( x  x  5  7  6  7)
	( 7  x  5  7  6  x))
  :gs '(( x  x  1  1  1  2)
	( 4  x  4  5  4  x)
	( 4  6  4  5  4  4)
	( 4  6  x  5  7  x)
	( 8  x  6  8  7  x)
	( x  6  6  8  7  8))
  :a  '(( 0  0  2  0  2  0)
	( 0  0  2  2  2  3)
	( x  0  2  0  2  0)
	( 3  x  2  2  2  0)
	( 5  7  5  6  5  5)
	( 5  7  x  6  8  x)
	( x  7  7  9  8  9)
	( x 10  x  9 10  9))
  :as '(( x  1  3  1  3  1)
	( 4  x  3  3  3  x)
	( x  1  3  3  3  4)
	( x  x  3  3  3  4)
	( 6  8  6  7  6  6)
	( 6  8  x  7  9  x)
	( x  8  8 10  9 10))
  :b  '(( x  0  1  2  0  2)
	( x  2  1  2  0  2)
	( x  2  4  2  4  2)
	( 2  2  1  2  0  2)
	( 2  2  4  2  4  2)
	( x  2  4  4  4  5)
	( 7  9  7  8  7  7)
	( 7  x  7  8  7  x)
	( 7  9  7  8 10  7))
  :c  '(( 3  3  2  3  1  0)
	( x  3  2  3  1  0)
	( x  x  2  3  1  3)
	( 3  3  5  3  5  3)
	( x  3  5  3  5  3)
	( x  3  5  5  5  6)
	( 8 10  8  9  8  8)
        ( 8 10  x  9 11  x))
  :cs '(( 4  4  3  4  2  x)
	( x  x  3  4  2  4)
	( 4  4  6  4  6  4)
	( x  4  6  6  6  7)
	( 9 11  9 10  9  9)
	( x 11 11 10 12  x))
  :d  '(( x  0  0  2  1  2)
	( x  x  0  2  1  2)
	( x  3  x  2  3  2)
	( x  x  4  5  3  5)
	( 5  5  4  5  3  x)
	( 5  5  7  5  7  5)
	( x  5  7  5  7  5)
	( x  5  7  7  7  8)
	( x  9 10  7 10  x))
  :ds '(( 1  1  3  1  3  1)
	( 2  3  x  2  3  2)
	( 3  x  1  3  2  x)
	( x  x  1  3  2  3)
	( 6  6  5  6  4  x)
	( x  6  8  8  8  9)))
	

(define-chord-family! +GUITAR-CHORDS+ '[sus4]
  :e '(( 0 2 2 2 0 0) ;; E B E A B E
       ( 0 2 2 2 5 5)
       ( x x 2 4 5 5)
       ( x 7 7 4 5 x)
       ( x x 9 9 10 7)
       ( 7 7 7 9 10 7))
  :f '(( 1 3 3 3 1 1)
       ( x x 3 3 1 1)
       ( x 3 3 3 6 6)
       ( x x 3 5 6 6)
       ( x 8 8 5 6 x)
       ( 8 8 8 10 11 8)
       ( x x 10 10 11 8))
  :fs '((2 4 4 4 2 2)
	(x x 4 4 2 2)
	(x 4 4 4 7 7)
	(x x 4 6 7 7)
	(x 9 9 6 7 x)
	(x x 9 6 7 9)
	(x x 11 11 12 9))
  :g '(( 3 5 5 5 3 3)
       ( 3 x 0 0 1 3)
       ( x 5 5 7 8 8)
       ( x x 10 7 8 10)
       ( x 10 10 7 8 x)
       ( x x 12 12 13 10))
  :gs '((x x 1 1 2 4)
	(x x 6 6 4 4)
	(4 6 6 6 4 4)
	(x 6 6 6 9 9)
	(x 11 11 8 9 x))
  :a '((0 0 2 2 3 0)
       (x 0 2 2 3 0)	
       (5 7 7 7 5 5)
       (x x 7 7 5 5)
       (x x 7 9 10 10)
       (x 7 7 7 10 10))
  :as '((1 1 1 3 4 1)
	(x x 3 3 4 1)
	(x x 3 3 4 6)
	(6 8 8 8 6 6)
	(x x 8 8 6 6)
	(x 8 8 8 11 11))
  :b '((2 2 2 4 5 2)
       (x x 4 4 5 2)
       (x x 4 4 5 7)
       (7 9 9 9 7 7)
       (x x 9 9 7 7)
       (x 9 9 9 12 12))
  :c '((x 3 3 0 1 1)
       (x x 3 0 1 3)
       (x 3 5 5 6 x)
       (3 3 3 5 6 3)
       (x x 5 5 6 8)
       (8 10 10 10 8 8))
  :cs '((x x 4 4 5 2)
	(4 4 4 6 7 4)
	(x 4 6 6 7 x)
	(x x 6 6 7 9)
	(x x 11 11 9 9)
	(x 11 11 11 14 14))
  :d '((x x 0 2 3 3)
       (x 5 5 2 3 x)
       (x x 7 7 8 5)
       (5 5 5 7 8 5)
       (x 5 7 7 8 x)
       (x x 7 7 8 10))
  :ds '((x 1 1 1 4 4)
	(x x 1 3 4 4)
	(x 6 6 3 4 x)
	(6 6 6 8 9 6)
	(x 6 8 8 9 x)
	(x x 8 8 9 6)))
	


(define-chord-family! +GUITAR-CHORDS+ '[min]
  :e  '(( 0  2  2  0  0  0) ;; E B E G B E
	( x  x  2  4  5  3)
	( x  x  2  4  5  3)
	( x  7  9  9  8  7))
  :f  '(( 1  3  3  1  1  1)
	( x  x  3  5  6  4)
	( x  8 10 10  9  8))
  :fs '(( 2  4  4  2  2  2)
	( x  x  4  6  7  5)
	( x  9 11 11 10  9))
  :g  '(( 3  5  5  3  3  3)
	( x  x  5  7  8  6)
	( x 10 12 12 11 10))
  :gs '(( 4  6  6  4  4  4)
	( x  x  6  8  9  5)
	( x 11 13 13 12 11))
  :a  '(( x  0  2  2  1  0)
	( 5  7  7  5  5  5)
	( x  x  7  9 10  8))
  :as '(( x  1  3  3  2  1)
	( 6  8  8  6  6  6)
	( x  x  8 10 11  9))
  :b  '(( x  2  4  4  3  2)
	( 7  9  9  7  7  7)
	( x  x  9 11 12 10))
  :c  '(( x  3  5  5  4  3)
	( 8 10 10  8  8  8)
	( x  x 10 12 13 11))
  :cs '(( x  4  6  6  5  4)
	( 9 11 11  9  9  9)
	( x  x 11 13 14 12))
  :d  '(( x  x  0  2  3  1)
	( x  5  7  7  6  5)
	(10 12 12 10 10 10))
  :ds '(( x  6  8  8  7  6)
	( x  x  1  3  4  2)
	(11 13 13 11 11 11)))

(define-chord-family! +GUITAR-CHORDS+ '[min7]
  :e '((0 x 0 0 0 0)
       (0 2 0 0 0 0)
       (0 2 0 0 3 0)
       (0 2 2 0 3 0)
       (0 2 2 0 3 3)
       (0 2 0 0 3 3)
       (x 5 5 4 5 x)
       (x 7 5 7 5 7)
       (x 7 9 7 8 x)
       (x x 1 3 2 2)
       (x x 2 4 3 3)
       (x x 0 12 12 12)
       (x x 0 9 8 7)
       (x 10 12 12 12 0))
  :f '((1 x 1 1 1 x)
       (1 3 1 1 1 1)
       (1 3 3 1 4 1)
       (x x 1 1 1 1)
       (x x 3 5 4 4)
       (x 8 6 8 6 8)
       (x 8 10 8 9 8))
  :fs '((2 x 2 2 2 x)
	(x x 2 2 2 2)
	(x 4 4 2 5 x)
	(x x 4 6 5 5)
	(x 9 7 9 7 9)
	(x 9 11 9 10 12))
  :g '((x 1 3 0 3 x)
       (x x 3 3 3 3)
       (3 x 3 3 3 x)
       (3 5 3 3 3 3)
       (3 5 3 3 6 3)
       (x x 5 7 6 6)
       (x x 8 10 8 10))
  :gs '((4 x 4 4 4 x)
	(4 6 4 4 7 4)
	(x x 4 4 4 4)
	(x x 6 8 7 7)
	(x x 9 11 9 11))
  :a '((0 0 2 0 1 3)
       (0 0 2 2 1 3)
       (x 0 5 5 5 8)
       (x x 5 5 5 5)
       (5 7 5 5 8 5))
  :as '((1 1 3 1 2 1)
	(x 1 3 1 2 1)
	(x 1 3 1 2 4)
	(x x 3 3 2 4)
	(x x 6 6 6 6)
	(6 x 6 6 6 x)
	(6 8 6 6 9 6))
  :b '((x 0 4 4 3 2)
       (x 2 4 2 3 2)
       (x 2 0 2 0 2)
       (x 2 0 2 3 2)
       (x 2 4 2 3 2)
       (5 x 4 4 3 x))
  :c '((3 x 1 3 1 x)
       (x 3 5 3 4 3)
       (x x 1 3 1 3)
       (x x 5 5 4 6)
       (8 x 8 8 8 x)
       (8 10 8 8 8 8)
       (8 10 8 8 11 8))
  :cs '((x 2 2 1 2 x)
	(x 4 2 1 0 0)
	(x 4 x 4 5 4)
	(x 4 6 4 5 7)	
	(x x 2 4 2 4)
	(9 x 9 9 9 x))
  :d '((x x 0 2 1 1)
       (x x 0 5 6 5)
       (x x 3 5 3 5)
       (x 5 7 5 6 5)
       (x x 7 7 6 8)
       (8 x 7 7 6 x))
  :ds '((2 x 1 3 2 x)
	(x x 1 3 2 2)
	(x 4 4 3 4 x)
	(x 6 4 6 4 6)
	(9 x 8 8 7 x)))

       
(sort-fret-model! +GUITAR-CHORDS+)
